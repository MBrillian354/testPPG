var ue=t=>{throw TypeError(t)};var J=(t,e,s)=>e.has(t)||ue("Cannot "+s);var r=(t,e,s)=>(J(t,e,"read from private field"),s?s.call(t):e.get(t)),b=(t,e,s)=>e.has(t)?ue("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,s),d=(t,e,s,i)=>(J(t,e,"write to private field"),i?i.call(t,s):e.set(t,s),s),x=(t,e,s)=>(J(t,e,"access private method"),s);import{f as Ce,p as de,g as E,s as K,h as z,n as Ie,i as Z,k as fe,t as je,l as we,m as Se,o as pe,q as be,r as I,v as Ne,S as Te,j as n,A as Ee,w as Oe,L as De,I as Qe}from"./index-CtFlY6jk.js";import{a as Fe}from"./attendanceCount-EC2MUpAe.js";import{S as Ue}from"./SequentialAnimation-C1Ipu751.js";import"./proxy-C2v1QtCt.js";var C,o,$,R,F,_,D,T,Y,L,M,U,k,Q,B,h,H,X,ee,te,se,re,ie,ae,ye,ve,ke=(ve=class extends Ce{constructor(e,s){super();b(this,h);b(this,C);b(this,o);b(this,$);b(this,R);b(this,F);b(this,_);b(this,D);b(this,T);b(this,Y);b(this,L);b(this,M);b(this,U);b(this,k);b(this,Q);b(this,B,new Set);this.options=s,d(this,C,e),d(this,T,null),d(this,D,de()),this.options.experimental_prefetchInRender||r(this,D).reject(new Error("experimental_prefetchInRender feature flag is not enabled")),this.bindMethods(),this.setOptions(s)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(r(this,o).addObserver(this),me(r(this,o),this.options)?x(this,h,H).call(this):this.updateResult(),x(this,h,se).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return ne(r(this,o),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return ne(r(this,o),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,x(this,h,re).call(this),x(this,h,ie).call(this),r(this,o).removeObserver(this)}setOptions(e,s){const i=this.options,u=r(this,o);if(this.options=r(this,C).defaultQueryOptions(e),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof E(this.options.enabled,r(this,o))!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");x(this,h,ae).call(this),r(this,o).setOptions(this.options),i._defaulted&&!K(this.options,i)&&r(this,C).getQueryCache().notify({type:"observerOptionsUpdated",query:r(this,o),observer:this});const c=this.hasListeners();c&&ge(r(this,o),u,this.options,i)&&x(this,h,H).call(this),this.updateResult(s),c&&(r(this,o)!==u||E(this.options.enabled,r(this,o))!==E(i.enabled,r(this,o))||z(this.options.staleTime,r(this,o))!==z(i.staleTime,r(this,o)))&&x(this,h,X).call(this);const a=x(this,h,ee).call(this);c&&(r(this,o)!==u||E(this.options.enabled,r(this,o))!==E(i.enabled,r(this,o))||a!==r(this,Q))&&x(this,h,te).call(this,a)}getOptimisticResult(e){const s=r(this,C).getQueryCache().build(r(this,C),e),i=this.createResult(s,e);return Ae(this,i)&&(d(this,R,i),d(this,_,this.options),d(this,F,r(this,o).state)),i}getCurrentResult(){return r(this,R)}trackResult(e,s){const i={};return Object.keys(e).forEach(u=>{Object.defineProperty(i,u,{configurable:!1,enumerable:!0,get:()=>(this.trackProp(u),s==null||s(u),e[u])})}),i}trackProp(e){r(this,B).add(e)}getCurrentQuery(){return r(this,o)}refetch({...e}={}){return this.fetch({...e})}fetchOptimistic(e){const s=r(this,C).defaultQueryOptions(e),i=r(this,C).getQueryCache().build(r(this,C),s);return i.fetch().then(()=>this.createResult(i,s))}fetch(e){return x(this,h,H).call(this,{...e,cancelRefetch:e.cancelRefetch??!0}).then(()=>(this.updateResult(),r(this,R)))}createResult(e,s){var le;const i=r(this,o),u=this.options,c=r(this,R),a=r(this,F),g=r(this,_),p=e!==i?e.state:r(this,$),{state:m}=e;let l={...m},S=!1,v;if(s._optimisticResults){const y=this.hasListeners(),P=!y&&me(e,s),A=y&&ge(e,i,s,u);(P||A)&&(l={...l,...Se(m.data,e.options)}),s._optimisticResults==="isRestoring"&&(l.fetchStatus="idle")}let{error:O,errorUpdatedAt:w,status:j}=l;if(s.select&&l.data!==void 0)if(c&&l.data===(a==null?void 0:a.data)&&s.select===r(this,Y))v=r(this,L);else try{d(this,Y,s.select),v=s.select(l.data),v=pe(c==null?void 0:c.data,v,s),d(this,L,v),d(this,T,null)}catch(y){d(this,T,y)}else v=l.data;if(s.placeholderData!==void 0&&v===void 0&&j==="pending"){let y;if(c!=null&&c.isPlaceholderData&&s.placeholderData===(g==null?void 0:g.placeholderData))y=c.data;else if(y=typeof s.placeholderData=="function"?s.placeholderData((le=r(this,M))==null?void 0:le.state.data,r(this,M)):s.placeholderData,s.select&&y!==void 0)try{y=s.select(y),d(this,T,null)}catch(P){d(this,T,P)}y!==void 0&&(j="success",v=pe(c==null?void 0:c.data,y,s),S=!0)}r(this,T)&&(O=r(this,T),v=r(this,L),w=Date.now(),j="error");const G=l.fetchStatus==="fetching",V=j==="pending",W=j==="error",ce=V&&G,he=v!==void 0,N={status:j,fetchStatus:l.fetchStatus,isPending:V,isSuccess:j==="success",isError:W,isInitialLoading:ce,isLoading:ce,data:v,dataUpdatedAt:l.dataUpdatedAt,error:O,errorUpdatedAt:w,failureCount:l.fetchFailureCount,failureReason:l.fetchFailureReason,errorUpdateCount:l.errorUpdateCount,isFetched:l.dataUpdateCount>0||l.errorUpdateCount>0,isFetchedAfterMount:l.dataUpdateCount>p.dataUpdateCount||l.errorUpdateCount>p.errorUpdateCount,isFetching:G,isRefetching:G&&!V,isLoadingError:W&&!he,isPaused:l.fetchStatus==="paused",isPlaceholderData:S,isRefetchError:W&&he,isStale:oe(e,s),refetch:this.refetch,promise:r(this,D)};if(this.options.experimental_prefetchInRender){const y=q=>{N.status==="error"?q.reject(N.error):N.data!==void 0&&q.resolve(N.data)},P=()=>{const q=d(this,D,N.promise=de());y(q)},A=r(this,D);switch(A.status){case"pending":e.queryHash===i.queryHash&&y(A);break;case"fulfilled":(N.status==="error"||N.data!==A.value)&&P();break;case"rejected":(N.status!=="error"||N.error!==A.reason)&&P();break}}return N}updateResult(e){const s=r(this,R),i=this.createResult(r(this,o),this.options);if(d(this,F,r(this,o).state),d(this,_,this.options),r(this,F).data!==void 0&&d(this,M,r(this,o)),K(i,s))return;d(this,R,i);const u={},c=()=>{if(!s)return!0;const{notifyOnChangeProps:a}=this.options,g=typeof a=="function"?a():a;if(g==="all"||!g&&!r(this,B).size)return!0;const f=new Set(g??r(this,B));return this.options.throwOnError&&f.add("error"),Object.keys(r(this,R)).some(p=>{const m=p;return r(this,R)[m]!==s[m]&&f.has(m)})};(e==null?void 0:e.listeners)!==!1&&c()&&(u.listeners=!0),x(this,h,ye).call(this,{...u,...e})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&x(this,h,se).call(this)}},C=new WeakMap,o=new WeakMap,$=new WeakMap,R=new WeakMap,F=new WeakMap,_=new WeakMap,D=new WeakMap,T=new WeakMap,Y=new WeakMap,L=new WeakMap,M=new WeakMap,U=new WeakMap,k=new WeakMap,Q=new WeakMap,B=new WeakMap,h=new WeakSet,H=function(e){x(this,h,ae).call(this);let s=r(this,o).fetch(this.options,e);return e!=null&&e.throwOnError||(s=s.catch(Ie)),s},X=function(){x(this,h,re).call(this);const e=z(this.options.staleTime,r(this,o));if(Z||r(this,R).isStale||!fe(e))return;const i=je(r(this,R).dataUpdatedAt,e)+1;d(this,U,setTimeout(()=>{r(this,R).isStale||this.updateResult()},i))},ee=function(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(r(this,o)):this.options.refetchInterval)??!1},te=function(e){x(this,h,ie).call(this),d(this,Q,e),!(Z||E(this.options.enabled,r(this,o))===!1||!fe(r(this,Q))||r(this,Q)===0)&&d(this,k,setInterval(()=>{(this.options.refetchIntervalInBackground||we.isFocused())&&x(this,h,H).call(this)},r(this,Q)))},se=function(){x(this,h,X).call(this),x(this,h,te).call(this,x(this,h,ee).call(this))},re=function(){r(this,U)&&(clearTimeout(r(this,U)),d(this,U,void 0))},ie=function(){r(this,k)&&(clearInterval(r(this,k)),d(this,k,void 0))},ae=function(){const e=r(this,C).getQueryCache().build(r(this,C),this.options);if(e===r(this,o))return;const s=r(this,o);d(this,o,e),d(this,$,e.state),this.hasListeners()&&(s==null||s.removeObserver(this),e.addObserver(this))},ye=function(e){be.batch(()=>{e.listeners&&this.listeners.forEach(s=>{s(r(this,R))}),r(this,C).getQueryCache().notify({query:r(this,o),type:"observerResultsUpdated"})})},ve);function Pe(t,e){return E(e.enabled,t)!==!1&&t.state.data===void 0&&!(t.state.status==="error"&&e.retryOnMount===!1)}function me(t,e){return Pe(t,e)||t.state.data!==void 0&&ne(t,e,e.refetchOnMount)}function ne(t,e,s){if(E(e.enabled,t)!==!1){const i=typeof s=="function"?s(t):s;return i==="always"||i!==!1&&oe(t,e)}return!1}function ge(t,e,s,i){return(t!==e||E(i.enabled,t)===!1)&&(!s.suspense||t.state.status!=="error")&&oe(t,s)}function oe(t,e){return E(e.enabled,t)!==!1&&t.isStaleByTime(z(e.staleTime,t))}function Ae(t,e){return!K(t.getCurrentResult(),e)}var Re=I.createContext(!1),_e=()=>I.useContext(Re);Re.Provider;function Le(){let t=!1;return{clearReset:()=>{t=!1},reset:()=>{t=!0},isReset:()=>t}}var Me=I.createContext(Le()),Be=()=>I.useContext(Me);function Ge(t,e){return typeof t=="function"?t(...e):!!t}function He(){}var $e=(t,e)=>{(t.suspense||t.throwOnError||t.experimental_prefetchInRender)&&(e.isReset()||(t.retryOnMount=!1))},Ye=t=>{I.useEffect(()=>{t.clearReset()},[t])},qe=({result:t,errorResetBoundary:e,throwOnError:s,query:i})=>t.isError&&!e.isReset()&&!t.isFetching&&i&&Ge(s,[t.error,i]),ze=t=>{t.suspense&&(t.staleTime===void 0&&(t.staleTime=1e3),typeof t.gcTime=="number"&&(t.gcTime=Math.max(t.gcTime,1e3)))},Ve=(t,e)=>t.isLoading&&t.isFetching&&!e,We=(t,e)=>(t==null?void 0:t.suspense)&&e.isPending,xe=(t,e,s)=>e.fetchOptimistic(t).catch(()=>{s.clearReset()});function Je(t,e,s){var m,l,S,v,O;const i=Ne(),u=_e(),c=Be(),a=i.defaultQueryOptions(t);(l=(m=i.getDefaultOptions().queries)==null?void 0:m._experimental_beforeQuery)==null||l.call(m,a),a._optimisticResults=u?"isRestoring":"optimistic",ze(a),$e(a,c),Ye(c);const g=!i.getQueryCache().get(a.queryHash),[f]=I.useState(()=>new e(i,a)),p=f.getOptimisticResult(a);if(I.useSyncExternalStore(I.useCallback(w=>{const j=u?()=>{}:f.subscribe(be.batchCalls(w));return f.updateResult(),j},[f,u]),()=>f.getCurrentResult(),()=>f.getCurrentResult()),I.useEffect(()=>{f.setOptions(a,{listeners:!1})},[a,f]),We(a,p))throw xe(a,f,c);if(qe({result:p,errorResetBoundary:c,throwOnError:a.throwOnError,query:i.getQueryCache().get(a.queryHash)}))throw p.error;if((v=(S=i.getDefaultOptions().queries)==null?void 0:S._experimental_afterQuery)==null||v.call(S,a,p),a.experimental_prefetchInRender&&!Z&&Ve(p,u)){const w=g?xe(a,f,c):(O=i.getQueryCache().get(a.queryHash))==null?void 0:O.promise;w==null||w.catch(He).finally(()=>{f.updateResult()})}return a.notifyOnChangeProps?p:f.trackResult(p)}function Ke(t,e){return Je(t,ke)}const Ze=({user:t,isLoading:e})=>{var c,a,g,f,p;const s=I.useContext(Te),i=()=>{s.toggle()},u=m=>m==null?void 0:m.split(" ").map(l=>l[0]).join("").toUpperCase().slice(0,2);return n.jsx("div",{className:"bg-white mb-2 p-4 shadow-sm fixed top-0 w-full ",children:n.jsxs("div",{className:"flex items-center space-x-4",children:[!e&&(t!=null&&t.image)?n.jsx("img",{onClick:i,src:`https://ppg-academic-system-9b62c1c7b604.herokuapp.com/api/${t.image}`,alt:t.name,className:"w-12 h-12 rounded-full  focus:bg-gray-200 hover:outline-none hover:ring-1 hover:ring-offset-1 hover:ring-gray-400"}):n.jsx("div",{onClick:i,className:`${e&&"animate-pulse"} w-12 h-12 rounded-full bg-green-200 text-green-500 flex items-center justify-center font-medium  focus:bg-gray-200 hover:outline-none hover:ring-1 hover:ring-offset-1 hover:ring-gray-400`,children:u(t==null?void 0:t.name)}),n.jsxs("div",{children:[e&&n.jsx("div",{className:"animate-pulse flex space-x-4",children:n.jsxs("div",{className:"flex-1 space-y-3 py-1 grow",children:[n.jsx("div",{className:"h-5 w-36 bg-slate-700 rounded"}),n.jsx("div",{className:"h-3 w-56 bg-slate-400 rounded"})]})}),!e&&n.jsxs(n.Fragment,{children:[n.jsx("h2",{className:"text-xl font-medium",children:t.name||"Unknown"}),n.jsxs("h3",{children:[((a=(c=t.userId)==null?void 0:c.teachingGroupId)==null?void 0:a.name)||"No TeachingGroup"," - ",((p=(f=(g=t.userId)==null?void 0:g.teachingGroupId)==null?void 0:f.branchId)==null?void 0:p.name)||"No Branch"]})]})]})]})})},Xe=({data:t})=>{var e,s;return n.jsxs("div",{className:"my-8",children:[n.jsx("h2",{className:"text-xl font-medium mb-2 ",children:t.name}),n.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[n.jsxs("div",{className:"card-basic rounded-md flex-col my-0 active:ring-1 w-full",children:[n.jsx("h3",{className:"text-gray-500 text-sm",children:"Peserta Didik"}),n.jsx("p",{className:"text-2xl font-bold",children:((e=t.students)==null?void 0:e.length)||"No Data"})]}),n.jsxs("div",{className:"card-basic rounded-md flex-col my-0 active:ring-1 w-full",children:[n.jsx("h3",{className:"text-gray-500 text-sm",children:"Total Pertemuan"}),n.jsx("p",{className:"text-2xl font-bold",children:t.attendances&&((s=t.teachingGroupYearId)!=null&&s.semesterTarget)?`${Fe(t)}`:"No Data"})]})]})]})},et=()=>{const[t,e]=I.useState(new Date);I.useEffect(()=>{const u=setInterval(()=>{e(new Date)},1e3);return()=>{clearInterval(u)}},[]);const s=u=>u.toLocaleDateString("id-ID",{weekday:"long",day:"2-digit",month:"long",year:"numeric",timeZone:"Asia/Jakarta"}),i=u=>u.toLocaleTimeString("id-ID",{hour12:!1,hour:"2-digit",minute:"2-digit",second:"2-digit",timeZone:"Asia/Jakarta"});return n.jsxs("div",{className:"space-y-1 mb-2 text-gray-600",children:[n.jsx("div",{className:"font-normal",children:s(t)}),n.jsxs("div",{className:"",children:[i(t)," WIB"]})]})},ot=()=>{const t=I.useContext(Ee);I.useContext(Oe);const e=async()=>{var p,m,l,S,v,O,w,j;console.log("fetching profile...");const a=await fetch(`https://ppg-academic-system-9b62c1c7b604.herokuapp.com/api/teachers/user/${t.userId}`);if(!a.ok)throw new Error("Failed to fetch user data");const g=await a.json();console.log(g);const f=((p=g.teacher)==null?void 0:p.classIds.map(G=>G._id))||[];return t.setAttributes((v=(S=(l=(m=g.teacher)==null?void 0:m.userId)==null?void 0:l.teachingGroupId)==null?void 0:S.branchId)==null?void 0:v.id,(j=(w=(O=g.teacher)==null?void 0:O.userId)==null?void 0:w.teachingGroupId)==null?void 0:j.id,f),g.teacher},{data:s,isLoading:i,error:u}=Ke({queryKey:["teacherData"],queryFn:e,staleTime:1e3*60*5});let c=0;return console.log(c),n.jsxs("div",{className:"flex flex-col",children:[n.jsx("div",{children:n.jsx(Ze,{user:s,isLoading:i})}),!s&&i&&n.jsx("div",{className:"flex justify-center mt-44",children:n.jsx(De,{size:32})}),s&&!i&&n.jsx(Ue,{children:n.jsxs("div",{className:"mt-20 flex-1 p-4",children:[n.jsxs("div",{className:"mb-4 space-y-1",children:[n.jsx("h1",{className:"text-xl font-medium",children:"Tenaga Pendidik"}),n.jsx(et,{})]}),n.jsxs("div",{className:"mb-4",children:[s.classIds.map((a,g)=>{var p,m;if((m=(p=a==null?void 0:a.teachingGroupYearId)==null?void 0:p.academicYearId)==null?void 0:m.isActive)return c++,n.jsx(Xe,{data:a},g)}),c===0&&n.jsx(Qe,{children:n.jsx("p",{children:"Belum terdaftar di kelas manapun. Hubungi PJP Kelompok!"})})]})]})})]})};export{ot as default};
