import{r as i,a as C,u as Y,A as w,j as e,M as G,L as l}from"./index-b338pBx7.js";const I=()=>{const[r,u]=i.useState({title:"",message:"",onConfirm:null}),[f,d]=i.useState(!1),[n,p]=i.useState(),{isLoading:t,error:T,sendRequest:c,setError:$}=C();Y();const g=i.useContext(w),j=g.userTeachingGroupId;i.useEffect(()=>{(async()=>{try{const s=await c("https://ppg-academic-system-9b62c1c7b604.herokuapp.com/api/academicYears?populate=teachingGroupYears");p(s.academicYears)}catch{}})()},[c]);const m=a=>{const s=a.substring(0,4),o=a.substring(4);return`${s}/${parseInt(s)+1} ${o==="1"?"Ganjil":"Genap"}`},b=(a,s)=>{const o=async()=>{const N="https://ppg-academic-system-9b62c1c7b604.herokuapp.com/api/teachingGroupYears",v=JSON.stringify({name:m(a),teachingGroupId:g.userTeachingGroupId,academicYearId:s});let h;try{h=await c(N,"POST",v,{"Content-Type":"application/json"}),u({title:"Berhasil!",message:h.message,onConfirm:null});const x=await c("https://ppg-academic-system-9b62c1c7b604.herokuapp.com/api/academicYears?populate=teachingGroupYears");p(x.academicYears)}catch{}};u({title:"Konfirmasi Pendaftaran",message:`Daftarkan tahun ajaran ${m(a)}?`,onConfirm:o}),d(!0)},y=()=>e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx("button",{onClick:()=>{d(!1)},className:`${r.onConfirm?"btn-danger-outline":"button-primary mt-0 "} ${t?"opacity-50 cursor-not-allowed":""}`,disabled:t,children:t?e.jsx(l,{}):r.onConfirm?"Batal":"Tutup"}),r.onConfirm&&e.jsx("button",{onClick:r.onConfirm,className:`button-primary mt-0 ${t?"opacity-50 cursor-not-allowed":""}`,children:t?e.jsx(l,{}):"Ya"})]});return e.jsx("div",{className:"min-h-screen bg-gray-50 px-4 py-8 md:p-8",children:e.jsxs("div",{className:"max-w-6xl mx-auto",children:[e.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Daftarkan Tahun Ajaran ke Kelompok"}),e.jsxs(G,{isOpen:f,onClose:()=>d(!1),title:r.title,footer:e.jsx(y,{}),children:[t&&e.jsx("div",{className:"flex justify-center mt-16",children:e.jsx(l,{size:32})}),!t&&r.message]}),(!n||t)&&e.jsx("div",{className:"flex justify-center mt-16",children:e.jsx(l,{size:32})}),n&&!t&&e.jsxs(e.Fragment,{children:[n.length===0&&e.jsx("div",{className:"bg-white rounded-md shadow-md p-6 border border-gray-200",children:e.jsx("p",{className:"text-gray-700 text-center",children:"DPD belum membuat tahun ajaran. Hubungi pihak terkait"})}),n.length>0&&e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:n.map(a=>{const s=a.teachingGroupYears.some(o=>o.teachingGroupId.id===j);return e.jsx("div",{className:`p-4 border rounded-lg transition-all duration-300 ${s?"bg-gray-100 border-gray-300 text-gray-500 cursor-not-allowed":"bg-white border-gray-200 hover:ring-4 hover:ring-blue-200 hover:border-blue-500 hover:shadow-xl cursor-pointer"}`,onClick:s?void 0:()=>b(a.name,a.id),children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h2",{className:"text-lg font-medium",children:m(a.name)}),s&&e.jsx("span",{className:"text-sm font-base text-gray-500",children:"Terdaftar âœ“"})]})},a._id)})})]})]})})};export{I as default};
