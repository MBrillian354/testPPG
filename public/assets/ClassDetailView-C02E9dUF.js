import{r as g,a as T,A as _,u as S,j as e,L as y,b as C}from"./index-CBFEDf3H.js";import{u as K}from"./http-hook-p1xhn-Qx.js";import{M as R}from"./ModalBottomClose-CrGWDDNY.js";import{E as z}from"./ErrorCard-DyotIidg.js";import{a as B}from"./attendanceCount-EC2MUpAe.js";import{L as E}from"./lock-open-DyOJoJj1.js";import{L as O}from"./lock-CzK2feI_.js";import{c as G}from"./createLucideIcon-BukOYC3u.js";import{C as H,a as J}from"./clock-Cn075oSk.js";import{G as I}from"./graduation-cap-CHibryFN.js";import{U as $}from"./users-BZmgMQSK.js";import{P as L}from"./plus-CgOwzzsp.js";import{T as Y}from"./trash-DWz3AGdx.js";/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U=G("Building",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F=G("KeyRound",[["path",{d:"M2.586 17.414A2 2 0 0 0 2 18.828V21a1 1 0 0 0 1 1h3a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1h1a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1h.172a2 2 0 0 0 1.414-.586l.814-.814a6.5 6.5 0 1 0-4-4z",key:"1s6t7t"}],["circle",{cx:"16.5",cy:"7.5",r:".5",fill:"currentColor",key:"w0ekpg"}]]),re=()=>{const{isLoading:c,error:j,sendRequest:r,setError:A}=K(),[a,f]=g.useState(),[d,n]=g.useState({title:"",message:"",onConfirm:null}),[b,x]=g.useState(!1),o=T().classId,p=g.useContext(_),N=S();g.useEffect(()=>{(async()=>{const t=`https://ppg-academic-system-9b62c1c7b604.herokuapp.com/api/classes/${o}?populate=all`;try{const l=await r(t);f(l),console.log(l)}catch{}})()},[r,o]);const M=(s,t)=>{const l=async()=>{const h="https://ppg-academic-system-9b62c1c7b604.herokuapp.com/api/classes/lock",u=JSON.stringify({classId:t});let m;try{m=await r(h,"PATCH",u,{"Content-Type":"application/json"}),n({title:"Berhasil!",message:m.message,onConfirm:null});const i=await r(`https://ppg-academic-system-9b62c1c7b604.herokuapp.com/api/classes/${t}?populate=all`);f(i)}catch(i){n({title:"Gagal!",message:i.message,onConfirm:null})}};n({title:`Kunci kelas: ${s}?`,message:"Kelas tidak akan bisa di-edit lagi!",onConfirm:l}),x(!0)},D=(s,t)=>{const l=async()=>{const h="https://ppg-academic-system-9b62c1c7b604.herokuapp.com/api/classes/unlock",u=JSON.stringify({classId:t});let m;try{m=await r(h,"PATCH",u,{"Content-Type":"application/json"}),n({title:"Berhasil!",message:m.message,onConfirm:null});const i=await r(`https://ppg-academic-system-9b62c1c7b604.herokuapp.com/api/classes/${t}?populate=all`);f(i)}catch(i){n({title:"Gagal!",message:i.message,onConfirm:null})}};n({title:`Buka kelas: ${s}?`,message:"Kelas dapat di-edit kembali",onConfirm:l}),x(!0)},k=(s,t,l)=>{const h=async()=>{const u=s==="teacher"?"https://ppg-academic-system-9b62c1c7b604.herokuapp.com/api/classes/remove-teacher":"https://ppg-academic-system-9b62c1c7b604.herokuapp.com/api/classes/remove-student",m=JSON.stringify(s==="teacher"?{classId:o,teacherId:l}:{classId:o,studentId:l});let i;try{i=await r(u,"DELETE",m,{"Content-Type":"application/json"}),n({title:"Berhasil!",message:i.message,onConfirm:null});const w=await r(`https://ppg-academic-system-9b62c1c7b604.herokuapp.com/api/classes/${o}?populate=all`);f(w)}catch{}};n({title:"Konfirmasi Penghapusan",message:`Hapus ${t} dari kelas ini?`,onConfirm:h}),x(!0)},v=s=>s==null?void 0:s.split(" ").map(t=>t[0]).join("").toUpperCase().slice(0,2),P=()=>e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx("button",{onClick:()=>{x(!1)},className:`${d.onConfirm?"btn-danger-outline":"button-primary mt-0 "} ${c?"opacity-50 cursor-not-allowed":""}`,disabled:c,children:c?e.jsx(y,{}):d.onConfirm?"Batal":"Tutup"}),d.onConfirm&&e.jsx("button",{onClick:d.onConfirm,className:`button-primary mt-0 ${c?"opacity-50 cursor-not-allowed":""}`,children:c?e.jsx(y,{}):"Ya"})]});return e.jsx("div",{className:"min-h-screen bg-gray-50 px-4 py-8 md:p-8 pb-24",children:e.jsxs("div",{className:"max-w-6xl mx-auto",children:[e.jsxs(R,{isOpen:b,onClose:()=>x(!1),title:d.title,footer:e.jsx(P,{}),children:[c&&e.jsx("div",{className:"flex justify-center mt-16",children:e.jsx(y,{size:32})}),!c&&d.message]}),(!a||c)&&!b&&e.jsx("div",{className:"flex justify-center mt-16",children:e.jsx(y,{size:32})}),j&&e.jsx(z,{error:j,onClear:()=>A(null)}),a&&!c&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("h1",{className:"text-2xl font-semibold text-gray-900",children:a.class.name}),!a.class.isLocked&&p.userRole==="admin kelompok"&&a.class.teachingGroupYearId.academicYearId.isActive===!0&&e.jsxs("button",{onClick:()=>M(a.class.name,a.class._id),disabled:a.class.isLocked,className:`btn-primary-outline font-medium flex flex-row items-start gap-2 ${a.class.isLocked?"text-blue-500 disabled:opacity-100":""}`,children:[e.jsx(E,{size:16}),"Kunci Kelas"]}),a.class.isLocked&&a.class.teachingGroupYearId.academicYearId.isActive===!0&&e.jsxs("button",{className:"btn-primary-outline font-medium flex flex-row items-start gap-2 text-blue-500 disabled:opacity-100",disabled:!0,children:[e.jsx(O,{size:16}),"Kelas Dikunci"]}),a.class.isLocked&&a.class.teachingGroupYearId.isActive===!1&&p.userRole==="admin kelompok"&&a.class.teachingGroupYearId.academicYearId.isActive===!0&&e.jsxs("button",{onClick:()=>D(a.class.name,a.class._id),className:"btn-danger-outline flex flex-row items-start gap-2 text-gray-600",children:[e.jsx(F,{size:16}),"Buka Kunci"]})]}),e.jsxs("div",{className:"mt-2 flex items-center text-gray-500",children:[e.jsx(U,{className:"mr-2 h-4 w-4"}),e.jsxs("span",{children:[a.class.teachingGroupYearId.teachingGroupId.name," - ",a.class.teachingGroupYearId.name]})]})]}),e.jsxs("div",{className:"flex flex-col gap-4 mb-8 rounded-md border border-gray-200 bg-white p-6 shadow-sm",children:[e.jsxs("div",{className:"flex items-center space-x-2 text-gray-600",children:[e.jsx(H,{className:"h-5 w-5"}),e.jsxs("span",{children:["Kelas Mulai: ",a.class.startTime]})]}),e.jsxs("div",{className:"flex items-center space-x-2 text-gray-600",children:[e.jsx(I,{className:"h-5 w-5"}),e.jsxs("span",{children:[a.class.teachers.length," Guru"]})]}),e.jsxs("div",{className:"flex items-center space-x-2 text-gray-600",children:[e.jsx($,{className:"h-5 w-5"}),e.jsxs("span",{children:[a.class.students.length," Siswa"]})]}),e.jsxs("div",{className:"flex items-center space-x-2 text-gray-600",children:[e.jsx(J,{className:"h-5 w-5"}),e.jsxs("span",{children:[B(a.class)," / ",a.class.teachingGroupYearId.semesterTarget," Pertemuan Terlaksana"]})]})]}),e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"mb-4 flex justify-between items-end",children:[e.jsxs("div",{className:"flex gap-1 items-center",children:[e.jsx(I,{className:"mr-2 h-5 w-5 text-gray-600"}),e.jsx("h2",{className:"text-xl font-medium text-gray-800",children:"Guru"})]}),p.userRole==="admin kelompok"&&a.class.isLocked===!1&&a.class.teachingGroupYearId.academicYearId.isActive===!0&&e.jsx(C,{to:`/dashboard/classes/${o}/add-teachers/`,children:e.jsxs("button",{className:"button-primary pl-[11px] mt-0",children:[e.jsx(L,{className:"w-4 h-4 mr-2"}),"Tambah Guru"]})})]}),e.jsx("div",{className:"rounded-md border border-gray-200 bg-white shadow-sm overflow-auto text-nowrap",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-white",children:e.jsxs("tr",{children:[e.jsx("th",{className:"pl-6 py-3 text-left text-sm font-medium text-gray-500"}),e.jsx("th",{className:"px-6 py-3 text-left text-sm font-medium text-gray-500",children:"Nama"}),e.jsx("th",{className:"px-6 py-3 text-left text-sm font-medium text-gray-500",children:"NID"}),e.jsx("th",{className:"px-6 py-3 text-left text-sm font-medium text-gray-500",children:"Posisi"}),e.jsx("th",{className:"px-6 py-3 text-left text-sm font-medium text-gray-500",children:"Nomor WA"}),p.userRole!=="teacher"&&a.class.isLocked===!1&&a.class.teachingGroupYearId.academicYearId.isActive===!0&&e.jsx("th",{className:"p-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Atur"})]})}),e.jsxs("tbody",{className:"divide-y divide-gray-200",children:[a.class.teachers.map(s=>e.jsxs("tr",{onClick:t=>{t.stopPropagation(),N(`/dashboard/teachers/${s._id}`)},className:"hover:bg-gray-50 hover:cursor-pointer transition",children:[e.jsx("td",{className:"p-4 ",children:s.image?e.jsx("img",{src:s!=null&&s.image?`https://ppg-academic-system-9b62c1c7b604.herokuapp.com/api/${s.image}`:"https://upload.wikimedia.org/wikipedia/commons/7/7c/Profile_avatar_placeholder_large.png?20150327203541",alt:s.name,className:"w-10 h-10 rounded-full min-w-10"}):e.jsx("div",{className:"w-10 h-10 rounded-full bg-green-200 text-green-500 flex items-center justify-center font-medium",children:v(s.name)})}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:s.name}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-600",children:s.nid}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-600",children:s.position}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-600",children:s.phone}),p.userRole!=="teacher"&&a.class.isLocked===!1&&a.class.teachingGroupYearId.academicYearId.isActive===!0&&e.jsx("td",{className:"flex gap-4 py-4",children:e.jsx("button",{onClick:t=>{t.stopPropagation(),k("teacher",s.name,s._id)},className:"p-3 rounded-full hover:bg-gray-200 text-red-500 hover:text-red-700 transition",children:e.jsx(Y,{size:20})})})]},s._id)),a.class.teachers.length===0&&e.jsx("tr",{className:"",children:e.jsx("td",{colSpan:"5",className:"px-6 py-4 text-sm text-gray-500 text-center",children:"Belum ada guru untuk kelas ini"})})]})]})})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"mb-4 flex justify-between items-end",children:[e.jsxs("div",{className:"flex gap-1 items-center",children:[e.jsx($,{className:"mr-2 h-5 w-5 text-gray-600"}),e.jsx("h2",{className:"text-xl font-medium text-gray-800",children:"Siswa"})]}),a.class.isLocked===!1&&e.jsx(C,{to:`/dashboard/classes/${o}/add-students/`,children:e.jsxs("button",{className:"button-primary pl-[11px] mt-0",children:[e.jsx(L,{className:"w-4 h-4 mr-2"}),"Tambah Siswa"]})})]}),e.jsx("div",{className:"rounded-md border border-gray-200 bg-white shadow-sm  overflow-auto text-nowrap",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-white",children:e.jsxs("tr",{children:[e.jsx("th",{className:"pl-6 py-3 text-left text-sm font-medium text-gray-500"}),e.jsx("th",{className:"px-6 py-3 text-left text-sm font-medium text-gray-500",children:"NIS"}),e.jsx("th",{className:"px-6 py-3 text-left text-sm font-medium text-gray-500",children:"Nama"}),p.userRole!=="teacher"&&a.class.isLocked===!1&&a.class.teachingGroupYearId.academicYearId.isActive===!0&&e.jsx("th",{className:"px-6 py-3 text-left text-sm font-medium text-gray-500",children:"Atur"})]})}),e.jsxs("tbody",{className:"divide-y divide-gray-200",children:[a.class.students.map(s=>e.jsxs("tr",{onClick:t=>{t.stopPropagation(),N(`/dashboard/students/${s._id}`)},className:"hover:bg-gray-50 hover:cursor-pointer transition",children:[e.jsx("td",{className:"p-4",children:s.image?e.jsx("img",{src:s!=null&&s.image?`https://ppg-academic-system-9b62c1c7b604.herokuapp.com/api/${s.image}`:"https://upload.wikimedia.org/wikipedia/commons/7/7c/Profile_avatar_placeholder_large.png?20150327203541",alt:s.name,className:"w-10 h-10 rounded-full min-w-10"}):e.jsx("div",{className:"w-10 h-10 rounded-full bg-blue-200 text-blue-500 flex items-center justify-center font-medium",children:v(s.name)})}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:s.nis}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:s.name}),a.class.isLocked===!1&&a.class.teachingGroupYearId.academicYearId.isActive===!0&&e.jsx("td",{className:"flex gap-4 py-4",children:e.jsx("button",{onClick:t=>{t.stopPropagation(),k("student",s.name,s._id)},className:"p-3 rounded-full  hover:bg-gray-200 text-red-500 hover:text-red-700 transition",children:e.jsx(Y,{size:20})})})]},s._id)),a.class.students.length===0&&e.jsx("tr",{className:"",children:e.jsx("td",{colSpan:"4",className:"px-6 py-4 text-sm text-gray-500 text-center",children:"Belum ada siswa terdaftar di kelas ini."})})]})]})})]})]})]})})};export{re as default};
