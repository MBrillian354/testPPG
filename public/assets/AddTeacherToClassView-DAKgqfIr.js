import{r as o,u as T,A as $,a as P,j as e,L as c}from"./index-CBFEDf3H.js";import{u as D}from"./http-hook-p1xhn-Qx.js";import{M as E}from"./ModalBottomClose-CrGWDDNY.js";import{E as I}from"./ErrorCard-DyotIidg.js";const R=()=>{const[r,d]=o.useState({title:"",message:"",className:"",onConfirm:null}),[j,m]=o.useState(!1),[i,g]=o.useState(),{isLoading:t,error:u,sendRequest:l,setError:b}=D();T();const x=o.useContext($).userTeachingGroupId,h=P().classId,y=h;o.useEffect(()=>{(async()=>{try{const a=await l(`https://ppg-academic-system-9b62c1c7b604.herokuapp.com/api/teachers/teaching-group/${x}`);g(a.teachers)}catch{}})()},[l]);const N=(s,a)=>{const n=async()=>{const k="https://ppg-academic-system-9b62c1c7b604.herokuapp.com/api/classes/register-teacher",w=JSON.stringify({classId:h,teacherId:a});let f;try{f=await l(k,"POST",w,{"Content-Type":"application/json"}),d({title:"Berhasil!",message:f.message,onConfirm:null});const p=await l(`https://ppg-academic-system-9b62c1c7b604.herokuapp.com/api/teachers/teaching-group/${x}`);g(p.teachers)}catch(p){d({title:"Gagal!",message:p.message,className:"text-red-500",onConfirm:null})}};d({title:"Konfirmasi Pendaftaran",message:`Daftarkan tenaga pendidik ${s}?`,onConfirm:n}),m(!0)},C=s=>s==null?void 0:s.split(" ").map(a=>a[0]).join("").toUpperCase().slice(0,2),v=()=>e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx("button",{onClick:()=>{m(!1)},className:`${r.onConfirm?"btn-danger-outline":"button-primary mt-0 "} ${t?"opacity-50 cursor-not-allowed":""}`,disabled:t,children:t?e.jsx(c,{}):r.onConfirm?"Batal":"Tutup"}),r.onConfirm&&e.jsx("button",{onClick:r.onConfirm,className:`button-primary mt-0 ${t?"opacity-50 cursor-not-allowed":""}`,children:t?e.jsx(c,{}):"Ya"})]});return e.jsx("div",{className:"min-h-screen bg-gray-50 px-4 py-8 md:p-8",children:e.jsxs("div",{className:"max-w-6xl mx-auto",children:[e.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Daftarkan Tenaga Pendidik ke Kelas"}),e.jsxs(E,{isOpen:j,onClose:()=>m(!1),title:r.title,footer:e.jsx(v,{}),children:[t&&e.jsx("div",{className:"flex justify-center mt-16 ",children:e.jsx(c,{size:32})}),e.jsx("div",{className:`${r.className}`,children:!t&&r.message})]}),u&&e.jsx("div",{className:"px-2",children:e.jsx(I,{error:u,onClear:()=>b(null)})}),(!i||t)&&e.jsx("div",{className:"flex justify-center mt-16",children:e.jsx(c,{size:32})}),i&&!t&&e.jsxs(e.Fragment,{children:[i.length===0&&e.jsx("div",{className:"bg-white rounded-md shadow-md p-6 border border-gray-200",children:e.jsx("p",{className:"text-gray-700 text-center",children:"Daerah belum menyediakan tenaga pendidik. Hubungi pihak terkait"})}),i.length>0&&e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:i.map(s=>{const a=s.classIds.some(n=>(n==null?void 0:n._id)===y);return e.jsx("div",{className:`p-4 border rounded-lg transition-all duration-300 ${a?"bg-gray-100 border-gray-300 text-gray-500 cursor-not-allowed":"bg-white border-gray-200 hover:ring-4 hover:ring-blue-200 hover:border-blue-500 hover:shadow-xl cursor-pointer"}`,onClick:a?void 0:()=>N(s.name,s.id),children:e.jsxs("div",{className:"flex justify-between items-center gap-2",children:[e.jsxs("div",{className:"flex gap-4 items-center",children:[s.image?e.jsx("img",{src:s!=null&&s.image?`https://ppg-academic-system-9b62c1c7b604.herokuapp.com/api/${s.image}`:"https://upload.wikimedia.org/wikipedia/commons/7/7c/Profile_avatar_placeholder_large.png?20150327203541",alt:s.name,className:"w-10 h-10 rounded-full hidden md:block"}):e.jsx("div",{className:"w-10 h-10 rounded-full bg-green-200 text-green-500 hidden md:flex items-center justify-center font-medium",children:C(s.name)}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("h2",{className:"text-lg font-medium",children:s.name}),e.jsx("h3",{className:"text-base font-normal",children:s.nid})]})]}),s.isProfileComplete===!1?e.jsx("span",{className:"text-sm font-medium text-red-500",children:"Lengkapi Profil!"}):a?e.jsx("span",{className:"text-sm font-base text-gray-500",children:"Terdaftar âœ“"}):e.jsx("span",{className:"text-sm font-medium text-blue-500 hidden hover:block",children:"Register"})]})},s._id)})})]})]})})};export{R as default};
