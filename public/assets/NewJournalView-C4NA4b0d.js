import{r as n,A as N,u as S,q as v,j as t,L as u}from"./index-CBFEDf3H.js";import{u as w}from"./http-hook-p1xhn-Qx.js";import{D as I}from"./DynamicForm-DnFPMFU5.js";import{E as T}from"./ErrorCard-DyotIidg.js";import{M as E}from"./ModalBottomClose-CrGWDDNY.js";import"./iconify-icon-C1YYA-Pd.js";const L=()=>{const[e,i]=n.useState({title:"",message:"",onConfirm:null}),[d,a]=n.useState(!1),[p,J]=n.useState(!1),{isLoading:s,error:o,sendRequest:x,setError:r}=w(),f=n.useContext(N),b=S();v();const j=[{name:"title",label:"Judul",type:"text",required:!0},{name:"content",label:"Isi Jurnal",type:"textarea",textAreaRows:6,required:!0}],g=async l=>{const y="https://ppg-academic-system-9b62c1c7b604.herokuapp.com/api/journals/",C=JSON.stringify({userId:f.userId,title:l.title,content:l.content});let m;try{m=await x(y,"POST",C,{"Content-Type":"application/json"})}catch(c){r(c.message),i({title:"Gagal!",message:c.message,onConfirm:null}),a(!0)}i({title:"Berhasil!",message:m.message,onConfirm:null}),a(!0)},h=()=>t.jsxs("div",{className:"flex gap-2 items-center",children:[t.jsx("button",{onClick:()=>{a(!1),!o&&b(-1)},className:`${e.onConfirm?"btn-danger-outline":"button-primary mt-0 "}`,children:e.onConfirm?"Batal":"Tutup"}),e.onConfirm&&t.jsx("button",{onClick:e.onConfirm,className:"button-primary mt-0 ",children:"Ya"})]});return t.jsxs("div",{className:"m-auto max-w-md mt-14 md:mt-8",children:[t.jsxs(E,{isOpen:d,onClose:()=>a(!1),title:e.title,footer:t.jsx(h,{}),children:[s&&t.jsx("div",{className:"flex justify-center mt-16",children:t.jsx(u,{size:32})}),!s&&e.message]}),o&&t.jsx("div",{className:"mx-2",children:t.jsx(T,{error:o,onClear:()=>r(null)})}),t.jsx("div",{className:`pb-24 transition-opacity duration-300 ${p?"opacity-0":"opacity-100"}`,children:t.jsx(I,{title:"Tambah Jurnal",subtitle:"Sistem Absensi Digital",fields:j,onSubmit:g,disabled:s,reset:!1,footer:!1,button:t.jsx("div",{className:"flex flex-col justify-stretch mt-4",children:t.jsx("button",{type:"submit",className:`button-primary ${s?"opacity-50 cursor-not-allowed":""}`,disabled:s,children:s?t.jsx(u,{children:"Processing..."}):"Simpan"})})})})]})};export{L as default};
