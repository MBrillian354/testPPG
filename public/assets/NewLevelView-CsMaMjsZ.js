import{r as s,a as C,A as w,u as A,j as e,M as B,E,D as L,L as u}from"./index-CMqcppKw.js";const M=()=>{const[h,r]=s.useState(!1),[p,b]=s.useState(""),[n,x]=s.useState(!0),[g,c]=s.useState(!1),{isLoading:t,error:d,sendRequest:o,setError:f}=C(),[i,y]=s.useState([]),[j,N]=s.useState();s.useContext(w);const T=A(),v=[{name:"name",label:"Nama Desa",placeholder:"Nama Desa",type:"text",required:!0},{name:"address",label:"Alamat Desa",placeholder:"Alamat Lengkap",type:"text",required:!0}];s.useEffect(()=>{(async()=>{try{const l=await o("https://ppg-academic-system-9b62c1c7b604.herokuapp.com/api/levels/branches/");y(l.branches)}catch{}})()},[o]),s.useEffect(()=>{i&&N([{name:"name",label:"Nama Kelompok",placeholder:"Nama Kelompok",type:"text",required:!0},{name:"address",label:"Alamat Kelompok",placeholder:"Alamat Lengkap",type:"text",required:!0},{name:"branch",label:"Desa",type:"select",required:!0,options:i.map(({name:a})=>({label:a,value:a}))}])},[i]);const D=async a=>{const l=n?"https://ppg-academic-system-9b62c1c7b604.herokuapp.com/api/levels/branches":"https://ppg-academic-system-9b62c1c7b604.herokuapp.com/api/levels/branches/teaching-groupes",k=JSON.stringify(n?{name:a.name,address:a.address}:{name:a.name,address:a.address,branchName:a.branch});let m;try{m=await o(l,"POST",k,{"Content-Type":"application/json"}),b(m.message),r(!0)}catch{}},S=()=>{c(!0),setTimeout(()=>{x(a=>!a),c(!1)},200)};return e.jsxs("div",{className:"m-auto max-w-md mt-14 md:mt-8",children:[e.jsx(B,{isOpen:h,onClose:()=>r(!1),title:"Berhasil!",footer:e.jsx(e.Fragment,{children:e.jsx("button",{onClick:()=>{r(!1),T("/settings/levels/")},className:"btn-danger-outline",children:"Tutup"})}),children:p}),e.jsxs("div",{className:`pb-24 transition-opacity duration-300 ${g?"opacity-0":"opacity-100"}`,children:[d&&e.jsx("div",{className:"mx-2",children:e.jsx(E,{error:d,onClear:()=>f(null)})}),e.jsx(L,{title:n?"Tambah Desa":"Tambah Kelompok",subtitle:"Sistem Absensi Digital",fields:n?v:j,onSubmit:D,disabled:t,reset:!1,footer:!1,button:e.jsxs("div",{className:"flex flex-col justify-stretch mt-4",children:[e.jsx("button",{type:"submit",className:`button-primary ${t?"opacity-50 cursor-not-allowed":""}`,disabled:t,children:t?e.jsx(u,{children:"Processing..."}):"Tambah"}),e.jsx("button",{type:"button",onClick:S,className:`button-secondary ${t?"opacity-50 cursor-not-allowed":""}`,disabled:t,children:t?e.jsx(u,{children:"Processing..."}):n?"Tambah Kelompok":"Tambah Desa"})]})})]})]})};export{M as default};
