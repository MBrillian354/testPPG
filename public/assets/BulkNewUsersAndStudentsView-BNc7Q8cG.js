import{r as e,u as S,A as N,j as t,L as C}from"./index-CBFEDf3H.js";import{u as T}from"./http-hook-p1xhn-Qx.js";import{D as v}from"./DynamicForm-DnFPMFU5.js";import{E as G}from"./ErrorCard-DyotIidg.js";import{M as w}from"./ModalBottomClose-CrGWDDNY.js";import"./iconify-icon-C1YYA-Pd.js";const P=()=>{const[o,c]=e.useState([]),{isLoading:a,error:u,sendRequest:n,setError:p}=T(),[m,d]=e.useState(),[h,l]=e.useState(!1),[b,g]=e.useState(!1);e.useState(""),e.useState(""),e.useState("student");const[A,f]=e.useState(""),y=S(),x=e.useContext(N);e.useEffect(()=>{(async()=>{try{const r=await n("https://ppg-academic-system-9b62c1c7b604.herokuapp.com/api/levels/branches/teaching-groupes");c(r.teachingGroups)}catch{}})()},[n]),e.useEffect(()=>{o&&d([{name:"count",label:"Jumlah Siswa",placeholder:"0",type:"number",required:!0},{name:"year",type:"year",label:"Tahun",value:new Date().getFullYear(),required:!0},{name:"teachingGroupName",label:"Kelompok",type:"select",required:!0,options:o.map(({name:s})=>({label:s,value:s}))}])},[o]);const k=async s=>{if(!s.count||s.count<=0){f("Please enter a valid count.");return}const r="https://ppg-academic-system-9b62c1c7b604.herokuapp.com/api/users/bulk-create",j=JSON.stringify({year:s.year,count:s.count,teachingGroupName:s.teachingGroupName,role:"student"});let i;try{i=await n(r,"POST",j,{"Content-Type":"application/json",Authorization:"Bearer "+x.token}),g(i.message),l(!0)}catch{}};return t.jsxs("div",{className:"m-auto max-w-md mt-14 md:mt-8",children:[t.jsx(w,{isOpen:h,onClose:()=>l(!1),title:"Berhasil!",footer:t.jsx(t.Fragment,{children:t.jsx("button",{onClick:()=>{l(!1),y("/settings/users/")},className:"btn-danger-outline",children:"Tutup"})}),children:b}),t.jsx("div",{className:"px-2",children:u&&t.jsx(G,{error:u,onClear:()=>p(null)})}),t.jsx(v,{title:"Tambah Akun Peserta Didik",subtitle:"Sistem Absensi Digital",fields:m||[{name:"count",label:"Jumlah Akun",placeholder:"0",type:"text",required:!0},{name:"teachingGroupName",label:"Kelompok",placeholder:"Kelompok",type:"text",required:!0},{name:"role",label:"Jenis Akun",placeholder:"Peserta Didik",type:"text",required:!0}],onSubmit:k,disabled:a,reset:!1,footer:!1,button:t.jsx("div",{className:"flex flex-col justify-stretch mt-4",children:t.jsx("button",{type:"submit",className:`button-primary ${a?"opacity-50 cursor-not-allowed":""}`,disabled:a,children:a?t.jsx(C,{children:"Processing..."}):"Tambah"})})})]})};export{P as default};
