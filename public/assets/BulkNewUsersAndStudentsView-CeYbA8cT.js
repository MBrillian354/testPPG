import{r as e,a as S,u as N,A as C,j as t,M as T,E as v,D as G,L as w}from"./index-b338pBx7.js";const E=()=>{const[n,c]=e.useState([]),{isLoading:a,error:u,sendRequest:o,setError:d}=S(),[p,m]=e.useState(),[h,l]=e.useState(!1),[g,b]=e.useState(!1);e.useState(""),e.useState(""),e.useState("student");const[A,f]=e.useState(""),x=N(),y=e.useContext(C);e.useEffect(()=>{(async()=>{try{const r=await o("http://192.168.137.1:5000/api/levels/branches/teaching-groupes");c(r.teachingGroups)}catch{}})()},[o]),e.useEffect(()=>{n&&m([{name:"count",label:"Jumlah Siswa",placeholder:"0",type:"number",required:!0},{name:"year",type:"year",label:"Tahun",value:new Date().getFullYear(),required:!0},{name:"teachingGroupName",label:"Kelompok",type:"select",required:!0,options:n.map(({name:s})=>({label:s,value:s}))}])},[n]);const k=async s=>{if(!s.count||s.count<=0){f("Please enter a valid count.");return}const r="http://192.168.137.1:5000/api/users/bulk-create",j=JSON.stringify({year:s.year,count:s.count,teachingGroupName:s.teachingGroupName,role:"student"});let i;try{i=await o(r,"POST",j,{"Content-Type":"application/json",Authorization:"Bearer "+y.token}),b(i.message),l(!0)}catch{}};return t.jsxs("div",{className:"m-auto max-w-md mt-14 md:mt-8",children:[t.jsx(T,{isOpen:h,onClose:()=>l(!1),title:"Berhasil!",footer:t.jsx(t.Fragment,{children:t.jsx("button",{onClick:()=>{l(!1),x("/settings/users/")},className:"btn-danger-outline",children:"Tutup"})}),children:g}),t.jsx("div",{className:"px-2",children:u&&t.jsx(v,{error:u,onClear:()=>d(null)})}),t.jsx(G,{title:"Tambah Akun Peserta Didik",subtitle:"Sistem Absensi Digital",fields:p||[{name:"count",label:"Jumlah Akun",placeholder:"0",type:"text",required:!0},{name:"teachingGroupName",label:"Kelompok",placeholder:"Kelompok",type:"text",required:!0},{name:"role",label:"Jenis Akun",placeholder:"Peserta Didik",type:"text",required:!0}],onSubmit:k,disabled:a,reset:!1,footer:!1,button:t.jsx("div",{className:"flex flex-col justify-stretch mt-4",children:t.jsx("button",{type:"submit",className:`button-primary ${a?"opacity-50 cursor-not-allowed":""}`,disabled:a,children:a?t.jsx(w,{children:"Processing..."}):"Tambah"})})})]})};export{E as default};
