import{r as i,a as A,u as L,j as e,L as c}from"./index-CUVeWTx6.js";import{u as S}from"./http-hook-BiPXVO_k.js";import{E as z}from"./ErrorCard-IpMuaMVp.js";import{M as E}from"./ModalBottomClose-We_XnTjp.js";import{m as x}from"./proxy-G5p5AvPC.js";import{c as u}from"./createLucideIcon-HjXMmH3n.js";import{A as g}from"./index-B6X7JfvK.js";import{C as I}from"./chevron-down-0-ryYE1k.js";/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M=u("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $=u("Pen",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O=u("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),q=()=>{const[o,P]=i.useState({title:"",message:"",onConfirm:null}),[f,p]=i.useState(!1),[n,j]=i.useState(),[l,h]=i.useState([]),{isLoading:r,error:y,sendRequest:b}=S(),m=A().classId,N=L();i.useEffect(()=>{m&&(async()=>{const a=`https://ppg-academic-system-9b62c1c7b604.herokuapp.com/api/attendances/class/${m}`;try{const s=await b(a);j(s)}catch{}})()},[m,b]);const C=t=>{h(a=>a.includes(t)?a.filter(s=>s!==t):[...a,t])},w=t=>{console.log("edit attendance",t),N(`/attendance/history/class/edit-confirmation/${t}`)},v=()=>{h([])},d=n==null?void 0:n.reduce((t,a)=>{const s=new Date(a.forDate).toLocaleDateString("id-ID",{weekday:"long",day:"numeric",month:"long",year:"numeric"});return t[s]=t[s]||[],t[s].push(a),t},{}),D=d?Object.keys(d).length:0,k=()=>e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx("button",{onClick:()=>{p(!1)},className:`${o.onConfirm?"btn-danger-outline":"button-primary mt-0 "} ${r?"opacity-50 cursor-not-allowed":""}`,disabled:r,children:r?e.jsx(c,{}):o.onConfirm?"Batal":"Tutup"}),o.onConfirm&&e.jsx("button",{onClick:o.onConfirm,className:`button-primary mt-0 ${r?"opacity-50 cursor-not-allowed":""}`,children:r?e.jsx(c,{}):"Ya"})]});return e.jsxs("div",{className:"p-4 space-y-4",children:[r&&!n&&e.jsx("div",{className:"flex justify-center mt-16",children:e.jsx(c,{size:32})}),e.jsxs(E,{isOpen:f,onClose:()=>p(!1),title:o.title,footer:e.jsx(k,{}),children:[r&&e.jsx("div",{className:"flex justify-center mt-16",children:e.jsx(c,{size:32})}),!r&&o.message]}),y&&e.jsx(z,{error:y,onClear:()=>setError(null)}),l.length>1&&D>1&&e.jsxs(x.button,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"flex items-center gap-2 px-4 py-2 border border-gray-300 bg-gray-100 hover:bg-gray-200 rounded-full text-sm font-medium transition-colors",onClick:v,children:[e.jsx(O,{size:16}),"Collapse All"]}),e.jsx(g,{children:d&&Object.entries(d).map(([t,a])=>e.jsxs(x.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"border shadow-sm rounded-full",children:[e.jsxs(x.button,{onClick:()=>C(t),className:`w-full px-3 py-2 flex justify-between items-center bg-blue-100 hover:bg-blue-200 transition-colors ${l.includes(t)?"rounded-t-md":"rounded-full"}`,children:[e.jsx("span",{className:"font-medium",children:t}),e.jsx("div",{className:"flex items-center gap-2",children:l.includes(t)?e.jsx(M,{size:16}):e.jsx(I,{size:16})})]}),e.jsx(g,{children:l.includes(t)&&e.jsx(x.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.3,ease:"easeInOut"},className:"overflow-hidden bg-white",children:e.jsxs("table",{className:"w-full table-auto border-collapse border border-gray-300",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-white",children:[e.jsx("th",{className:"border-t border-gray-300 p-2 text-left text-xs text-gray-500",children:"Nama"}),e.jsx("th",{className:"border-t border-gray-300 p-2 text-left text-xs text-gray-500",children:"Status"}),e.jsx("th",{className:"border-t border-gray-300 p-2 text-left text-xs text-gray-500",children:"Atribut"}),e.jsx("th",{className:"border-t border-gray-300 p-2 text-left text-xs text-gray-500",children:"Waktu"}),e.jsx("th",{className:"border-t border-gray-300 text-left text-xs text-gray-500"})]})}),e.jsx("tbody",{children:a.map(s=>e.jsxs("tr",{className:"bg-white hover:bg-gray-100",children:[e.jsx("td",{className:"border-t border-gray-300 p-2 text-xs",children:s.studentId.name}),e.jsx("td",{className:"border-t border-gray-300 p-2 text-xs",children:s.status}),e.jsx("td",{className:"border-t border-gray-300 p-2 text-xs",children:s.attributes?"Ya":"Tidak"}),e.jsx("td",{className:"border-t border-gray-300 p-2 text-xs",children:new Date(s.timestamp).toLocaleTimeString("id-ID",{hour:"2-digit",minute:"2-digit",second:"2-digit"})}),new Date().toLocaleDateString("en-CA")!==new Date(s.forDate).toLocaleDateString("en-CA")&&e.jsx("td",{className:"border-t border-gray-300 text-xs flex",children:e.jsx("button",{onClick:()=>w(s._id),className:"p-1 rounded-full active:bg-gray-200 text-blue-500 active:text-blue-700 transition duration-300",children:e.jsx($,{size:16})})})]},s._id))})]})})})]},t))})]})};export{q as default};
