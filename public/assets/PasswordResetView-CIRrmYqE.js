import{r as u,a as g,u as w,b as v,j as e,M as N,L as c,E as x,D as h}from"./index-BgrALROI.js";const C=()=>{const[a,n]=u.useState({title:"",message:"",onConfirm:null}),[y,r]=u.useState(!1),{isLoading:s,error:m,sendRequest:d,setError:p}=g(),o=w(),l=v().token,f=async i=>{try{const t=await d("https://ppg-academic-system-9b62c1c7b604.herokuapp.com/api/users/request-reset-password","POST",JSON.stringify({email:i.email}),{"Content-Type":"application/json"});console.log(t),n({title:"Berhasil!",message:t.message,onConfirm:null}),r(!0)}catch(t){n({title:"Gagal!",message:t.message,onConfirm:null}),r(!0)}},b=async i=>{try{const t=await d("https://ppg-academic-system-9b62c1c7b604.herokuapp.com/api/users/reset-password","POST",JSON.stringify({token:i.token,newPassword:i.newPassword}),{"Content-Type":"application/json"});n({title:"Berhasil!",message:t.message,onConfirm:null}),r(!0)}catch(t){n({title:"Gagal!",message:t.message,onConfirm:null}),r(!0)}},j=()=>e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx("button",{onClick:()=>{r(!1),o("/")},className:`${a.onConfirm?"btn-danger-outline":"button-primary mt-0 "}`,children:a.onConfirm?"Batal":"Tutup"}),a.onConfirm&&e.jsx("button",{onClick:a.onConfirm,className:"button-primary mt-0 ",children:"Ya"})]});return e.jsx("div",{className:"m-auto max-w-md mt-16 md:mt-24",children:e.jsxs("div",{className:"pb-24 transition-opacity duration-300",children:[e.jsxs(N,{isOpen:y,onClose:()=>r(!1),title:a.title,footer:e.jsx(j,{}),children:[s&&e.jsx("div",{className:"flex justify-center mt-16",children:e.jsx(c,{size:32})}),!s&&a.message]}),m&&e.jsx("div",{className:"px-2",children:e.jsx(x,{error:m,onClear:()=>p(null)})}),l==="reset"?e.jsx(h,{title:"Reset Password",fields:[{name:"email",label:"Email",placeholder:"Email",type:"email",required:!0}],onSubmit:f,disabled:s,labels:!1,footer:!1,customDescription:e.jsx("p",{className:"text-center text-sm text-gray-500",children:"Masukkan email yang terdaftar untuk mereset password"}),button:e.jsx("div",{className:"flex flex-col justify-stretch mt-4",children:e.jsx("button",{type:"submit",className:`button-primary ${s?"opacity-50 cursor-not-allowed":""}`,disabled:s,children:s?e.jsx(c,{children:"Mengirim email..."}):"Reset"})}),helpButton:e.jsx("div",{onClick:()=>o(-1),className:"text-center mt-2",children:e.jsx("p",{className:"underline text-xs text-gray-600 active:text-primary hover:text-primary hover:cursor-pointer",children:"Kembali ke Login"})})}):l?e.jsx(h,{title:"Reset Password",fields:[{name:"token",type:"hidden",value:l},{name:"newPassword",label:"Password Baru",placeholder:"password baru",type:"password",required:!0},{name:"confirmPassword",label:"Konfirmasi Password",placeholder:"konfirmasi password baru",type:"password",required:!0}],onSubmit:b,disabled:s,labels:!1,footer:!1,customDescription:e.jsx("p",{className:"text-center text-sm text-gray-500",children:"Masukkan password baru"}),button:e.jsx("div",{className:"flex flex-col justify-stretch mt-4",children:e.jsx("button",{type:"submit",className:`button-primary ${s?"opacity-50 cursor-not-allowed":""}`,disabled:s,children:s?e.jsx(c,{children:"Processing..."}):"Update Password"})}),helpButton:e.jsx("div",{onClick:()=>o(-1),className:"text-center mt-2",children:e.jsx("p",{className:"underline text-xs text-gray-600 active:text-primary hover:text-primary hover:cursor-pointer",children:"Kembali ke Login"})})}):e.jsxs("div",{className:"px-2",children:[e.jsx(x,{error:"Invalid Token!",onClear:()=>p(null)}),e.jsx("div",{onClick:()=>o(-1),className:"text-center mt-2",children:e.jsx("p",{className:"underline text-xs text-gray-600 active:text-primary hover:text-primary hover:cursor-pointer",children:"Kembali ke Login"})})]})]})})};export{C as default};
