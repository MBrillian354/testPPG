import{r as n,b as N,A as v,u as S,z as w,j as e,M as I,L as u,E as T,D as E}from"./index-Baf2cdGO.js";const O=()=>{const[t,i]=n.useState({title:"",message:"",onConfirm:null}),[d,a]=n.useState(!1),[x,J]=n.useState(!1),{isLoading:s,error:o,sendRequest:p,setError:r}=N(),f=n.useContext(v),j=S();w();const b=[{name:"title",label:"Judul",type:"text",required:!0},{name:"content",label:"Isi Jurnal",type:"textarea",textAreaRows:6,required:!0}],h=async l=>{const y="http://103.127.133.63:5000/api/journals/",C=JSON.stringify({userId:f.userId,title:l.title,content:l.content});let c;try{c=await p(y,"POST",C,{"Content-Type":"application/json"})}catch(m){r(m.message),i({title:"Gagal!",message:m.message,onConfirm:null}),a(!0)}i({title:"Berhasil!",message:c.message,onConfirm:null}),a(!0)},g=()=>e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx("button",{onClick:()=>{a(!1),!o&&j(-1)},className:`${t.onConfirm?"btn-danger-outline":"button-primary mt-0 "}`,children:t.onConfirm?"Batal":"Tutup"}),t.onConfirm&&e.jsx("button",{onClick:t.onConfirm,className:"button-primary mt-0 ",children:"Ya"})]});return e.jsxs("div",{className:"m-auto max-w-md mt-14 md:mt-8",children:[e.jsxs(I,{isOpen:d,onClose:()=>a(!1),title:t.title,footer:e.jsx(g,{}),children:[s&&e.jsx("div",{className:"flex justify-center mt-16",children:e.jsx(u,{size:32})}),!s&&t.message]}),o&&e.jsx("div",{className:"mx-2",children:e.jsx(T,{error:o,onClear:()=>r(null)})}),e.jsx("div",{className:`pb-24 transition-opacity duration-300 ${x?"opacity-0":"opacity-100"}`,children:e.jsx(E,{subtitle:"Tambah Jurnal",fields:b,onSubmit:h,disabled:s,reset:!1,footer:!1,button:e.jsx("div",{className:"flex flex-col justify-stretch mt-4",children:e.jsx("button",{type:"submit",className:`button-primary ${s?"opacity-50 cursor-not-allowed":""}`,disabled:s,children:s?e.jsx(u,{children:"Processing..."}):"Simpan"})})})})]})};export{O as default};
