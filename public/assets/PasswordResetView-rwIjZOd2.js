import{r as p,u as g,a as w,j as e,L as m}from"./index-CUVeWTx6.js";import{u as v}from"./http-hook-BiPXVO_k.js";import{E as x}from"./ErrorCard-IpMuaMVp.js";import{D as h}from"./DynamicForm-Biq1uxbt.js";import{M as N}from"./ModalBottomClose-We_XnTjp.js";import"./iconify-icon-C1YYA-Pd.js";const O=()=>{const[a,o]=p.useState({title:"",message:"",onConfirm:null}),[f,r]=p.useState(!1),{isLoading:s,error:c,sendRequest:d,setError:u}=v(),n=g(),l=w().token,y=async i=>{try{const t=await d("http://192.168.1.13:5000/api/users/request-reset-password","POST",JSON.stringify({email:i.email}),{"Content-Type":"application/json"});console.log(t),o({title:"Berhasil!",message:t.message,onConfirm:null}),r(!0)}catch(t){o({title:"Gagal!",message:t.message,onConfirm:null}),r(!0)}},j=async i=>{try{const t=await d("http://192.168.1.13:5000/api/users/reset-password","POST",JSON.stringify({token:i.token,newPassword:i.newPassword}),{"Content-Type":"application/json"});o({title:"Berhasil!",message:t.message,onConfirm:null}),r(!0)}catch(t){o({title:"Gagal!",message:t.message,onConfirm:null}),r(!0)}},b=()=>e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx("button",{onClick:()=>{r(!1),n("/")},className:`${a.onConfirm?"btn-danger-outline":"button-primary mt-0 "}`,children:a.onConfirm?"Batal":"Tutup"}),a.onConfirm&&e.jsx("button",{onClick:a.onConfirm,className:"button-primary mt-0 ",children:"Ya"})]});return e.jsx("div",{className:"m-auto max-w-md mt-16 md:mt-24",children:e.jsxs("div",{className:"pb-24 transition-opacity duration-300",children:[e.jsxs(N,{isOpen:f,onClose:()=>r(!1),title:a.title,footer:e.jsx(b,{}),children:[s&&e.jsx("div",{className:"flex justify-center mt-16",children:e.jsx(m,{size:32})}),!s&&a.message]}),c&&e.jsx("div",{className:"px-2",children:e.jsx(x,{error:c,onClear:()=>u(null)})}),l==="reset"?e.jsx(h,{title:"Reset Password",fields:[{name:"email",label:"Email",placeholder:"Email",type:"email",required:!0}],onSubmit:y,disabled:s,labels:!1,footer:!1,customDescription:e.jsx("p",{className:"text-center text-sm text-gray-500",children:"Masukkan email yang terdaftar untuk mereset password"}),button:e.jsx("div",{className:"flex flex-col justify-stretch mt-4",children:e.jsx("button",{type:"submit",className:`button-primary ${s?"opacity-50 cursor-not-allowed":""}`,disabled:s,children:s?e.jsx(m,{children:"Mengirim email..."}):"Reset"})}),helpButton:e.jsx("div",{onClick:()=>n(-1),className:"text-center mt-2",children:e.jsx("p",{className:"underline text-xs text-gray-600 active:text-primary hover:text-primary hover:cursor-pointer",children:"Kembali ke Login"})})}):l?e.jsx(h,{title:"Reset Password",fields:[{name:"token",type:"hidden",value:l},{name:"newPassword",label:"Password Baru",placeholder:"password baru",type:"password",required:!0},{name:"confirmPassword",label:"Konfirmasi Password",placeholder:"konfirmasi password baru",type:"password",required:!0}],onSubmit:j,disabled:s,labels:!1,footer:!1,customDescription:e.jsx("p",{className:"text-center text-sm text-gray-500",children:"Masukkan password baru"}),button:e.jsx("div",{className:"flex flex-col justify-stretch mt-4",children:e.jsx("button",{type:"submit",className:`button-primary ${s?"opacity-50 cursor-not-allowed":""}`,disabled:s,children:s?e.jsx(m,{children:"Processing..."}):"Update Password"})}),helpButton:e.jsx("div",{onClick:()=>n(-1),className:"text-center mt-2",children:e.jsx("p",{className:"underline text-xs text-gray-600 active:text-primary hover:text-primary hover:cursor-pointer",children:"Kembali ke Login"})})}):e.jsxs("div",{className:"px-2",children:[e.jsx(x,{error:"Invalid Token!",onClear:()=>u(null)}),e.jsx("div",{onClick:()=>n(-1),className:"text-center mt-2",children:e.jsx("p",{className:"underline text-xs text-gray-600 active:text-primary hover:text-primary hover:cursor-pointer",children:"Kembali ke Login"})})]})]})})};export{O as default};
